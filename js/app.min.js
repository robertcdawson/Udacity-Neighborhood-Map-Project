function initMap(){function a(a){null!==a.getAnimation()?a.setAnimation(null):(a.setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){a.setAnimation(null)},1500))}var o=document.getElementById("map"),n=new google.maps.Map(o,{zoom:17,center:{lat:37.796,lng:-122.396},disableDefaultUI:!0}),t=function(){var a=0;for(a;a<vm.locations.length;a++)vm.infowindow_array[a].close()};vm.panToLocation=function(o){var e=o.title?o.title:o.name,i=o.position?o.position.lat():o.lat,l=o.position?o.position.lng():o.lng;n.panTo({lat:i,lng:l}),t();var r=0;for(r;r<vm.locations.length;r++)vm.locations[r].name===e&&(vm.infowindow_array[r].open(n,vm.location_array[r]),vm.lat(vm.locations[r].lat),vm.lon(vm.locations[r].lng),a(vm.location_array[r]));vm.flickrApi("https://api.flickr.com/services/rest/?method=flickr.photos.search&api_key=594fb249392c0301ff092bb17a325a16&safe_search=1&per_page=10&lat="+vm.lat()+"&lon="+vm.lon()+"&text="+e+"&sort=relevance&format=json&jsoncallback=?"),vm.updateJson()};var e=function(){vm.highlightListItem(this.title),vm.panToLocation(this)},i=function(){vm.updateJson=function(){$.getJSON(vm.flickrApi()).done(function(a){vm.srcs(a)}).fail(function(){$("#error_msg").html('"Error: Flickr data did not load. Please <a href="'+window.location.href+'">reload</a> to try again.').show()})};var a=0;for(a;a<vm.locations.length;a++)vm.location_array[a]=new google.maps.Marker({map:n,position:{lat:vm.locations[a].lat,lng:vm.locations[a].lng},title:vm.locations[a].name,animation:google.maps.Animation.DROP}),vm.infowindow_array[a]=new google.maps.InfoWindow({content:'<h1 class="firstHeading">'+vm.locations[a].name+"</h1>"}),vm.location_array[a].addListener("click",e)};i()}var ViewModel=function(){var a=this;a.locations=[{name:"Blue Bottle Coffee",lat:37.796184,lng:-122.393799},{name:"The Plant Cafe Organic",lat:37.797913,lng:-122.396036},{name:"Cowgirl Creamery Cheese Shop",lat:37.79576,lng:-122.393338},{name:"Paramo Coffee",lat:37.794628,lng:-122.396009},{name:"Boulettes Larder",lat:37.795514,lng:-122.393477}],a.nav=ko.observableArray(a.locations),a.filter=ko.observable(""),a.filteredNav=ko.computed(function(){var o=a.filter().toLowerCase();return o?a.nav().filter(function(a){return a.name.toLowerCase().indexOf(o)>-1||a.name.indexOf(o)>-1}):a.nav()}),a.highlightListItem=function(a){var o;"string"==typeof a?o=a:"object"==typeof a&&(o=a.name);var n=$(".mdl-navigation a:contains("+o+")");$(".mdl-navigation a").removeClass("mdl-navigation__link--current"),$(n).addClass("mdl-navigation__link--current")},a.panToLocation=ko.observable(),a.location_array=ko.observableArray(),a.infowindow_array=ko.observableArray(),a.clickListItem=function(o){a.highlightListItem(o),a.panToLocation(o)},a.lat=ko.observable(37.796184),a.lon=ko.observable(-122.393799),a.flickrApi=ko.observable("https://api.flickr.com/services/rest/?method=flickr.photos.search&api_key=594fb249392c0301ff092bb17a325a16&safe_search=1&per_page=10&lat="+a.lat()+"&lon="+a.lon()+"&format=json&jsoncallback=?"),a.srcs=ko.observableArray(),a.updateJson=ko.observable(),$.getJSON(a.flickrApi()).done(function(o){a.srcs(o)}).fail(function(){$("#error_msg").html('Error: Flickr data did not load. Please <a href="'+window.location.href+'">reload</a> to try again.').show()})};if("object"==typeof ko){var vm=new ViewModel;ko.applyBindings(vm)}else $("#error_msg").html('Error: Knockout.js did not load. Please <a href="'+window.location.href+'">reload</a> to try again.').show();var map_url="https://maps.googleapis.com/maps/api/js?key=AIzaSyDCDm6-E4pK_fRcLMpRYEMnnaPKXYjl7aw";$.getScript(map_url).done(function(){initMap()}).fail(function(){$("#error_msg").html('Error: Map data did not load. Please <a href="'+window.location.href+'">reload</a> to try again.').show()}),$.ajaxSetup({cache:!0});